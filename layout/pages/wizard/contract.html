<!--begin::Page Custom Styles(used by this page) -->
<link href="../../layout/assets/css/pages/wizard/wizard-1.css" rel="stylesheet" type="text/css" />

<!--Begin::Row-->
<!--Begin::Section-->
<div class="row">
    <div class="col-lg-12 col-xl-12 order-lg-1 order-xl-1">
        <div class="kt-container  kt-container--fluid  kt-grid__item kt-grid__item--fluid">
            <div class="kt-portlet">
                <div class="kt-portlet__body kt-portlet__body--fit">
                    <div class="kt-grid  kt-wizard-v1 kt-wizard-v1--white" id="kt_projects_add" data-ktwizard-state="step-first">
                        <div class="kt-grid__item">

                            <!--begin: Form Wizard Nav -->
                            <div class="kt-wizard-v1__nav">
                                <div class="kt-wizard-v1__nav-items">

                                    <!--doc: Replace A tag with SPAN tag to disable the step link click -->
                                    <div class="kt-wizard-v1__nav-item" id="ctstepSatu" data-ktwizard-type="step" >
                                        <div class="kt-wizard-v1__nav-body">
                                            <div class="kt-wizard-v1__nav-icon">
                                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" class="kt-svg-icon kt-svg-icon--xl">
                                                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                                        <rect x="0" y="0" width="24" height="24" />
                                                        <path d="M4.875,20.75 C4.63541667,20.75 4.39583333,20.6541667 4.20416667,20.4625 L2.2875,18.5458333 C1.90416667,18.1625 1.90416667,17.5875 2.2875,17.2041667 C2.67083333,16.8208333 3.29375,16.8208333 3.62916667,17.2041667 L4.875,18.45 L8.0375,15.2875 C8.42083333,14.9041667 8.99583333,14.9041667 9.37916667,15.2875 C9.7625,15.6708333 9.7625,16.2458333 9.37916667,16.6291667 L5.54583333,20.4625 C5.35416667,20.6541667 5.11458333,20.75 4.875,20.75 Z" fill="#000000" fill-rule="nonzero" opacity="0.3" />
                                                        <path d="M2,11.8650466 L2,6 C2,4.34314575 3.34314575,3 5,3 L19,3 C20.6568542,3 22,4.34314575 22,6 L22,15 C22,15.0032706 21.9999948,15.0065399 21.9999843,15.009808 L22.0249378,15 L22.0249378,19.5857864 C22.0249378,20.1380712 21.5772226,20.5857864 21.0249378,20.5857864 C20.7597213,20.5857864 20.5053674,20.4804296 20.317831,20.2928932 L18.0249378,18 L12.9835977,18 C12.7263047,14.0909841 9.47412135,11 5.5,11 C4.23590829,11 3.04485894,11.3127315 2,11.8650466 Z M6,7 C5.44771525,7 5,7.44771525 5,8 C5,8.55228475 5.44771525,9 6,9 L15,9 C15.5522847,9 16,8.55228475 16,8 C16,7.44771525 15.5522847,7 15,7 L6,7 Z" fill="#000000" />
                                                    </g>
                                                </svg> </div>
                                            <div class="kt-wizard-v1__nav-label">
                                                Assign Leads
                                            </div>
                                        </div>
                                    </div>
                                    <div class="kt-wizard-v1__nav-item" id="ctstepDua" data-ktwizard-type="step">
                                        <div class="kt-wizard-v1__nav-body">
                                            <div class="kt-wizard-v1__nav-icon">
                                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" class="kt-svg-icon kt-svg-icon--xl">
                                                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                                        <rect x="0" y="0" width="24" height="24" />
                                                        <path d="M11,20 L11,17 C11,16.4477153 11.4477153,16 12,16 C12.5522847,16 13,16.4477153 13,17 L13,20 L15.5,20 C15.7761424,20 16,20.2238576 16,20.5 C16,20.7761424 15.7761424,21 15.5,21 L8.5,21 C8.22385763,21 8,20.7761424 8,20.5 C8,20.2238576 8.22385763,20 8.5,20 L11,20 Z" fill="#000000" opacity="0.3" />
                                                        <path d="M3,5 L21,5 C21.5522847,5 22,5.44771525 22,6 L22,16 C22,16.5522847 21.5522847,17 21,17 L3,17 C2.44771525,17 2,16.5522847 2,16 L2,6 C2,5.44771525 2.44771525,5 3,5 Z M4.5,8 C4.22385763,8 4,8.22385763 4,8.5 C4,8.77614237 4.22385763,9 4.5,9 L13.5,9 C13.7761424,9 14,8.77614237 14,8.5 C14,8.22385763 13.7761424,8 13.5,8 L4.5,8 Z M4.5,10 C4.22385763,10 4,10.2238576 4,10.5 C4,10.7761424 4.22385763,11 4.5,11 L7.5,11 C7.77614237,11 8,10.7761424 8,10.5 C8,10.2238576 7.77614237,10 7.5,10 L4.5,10 Z" fill="#000000" />
                                                    </g>
                                                </svg> </div>
                                            <div class="kt-wizard-v1__nav-label">
                                                Contract
                                            </div>
                                        </div>
                                    </div>
                                    <div class="kt-wizard-v1__nav-item" id="ctstepTiga" data-ktwizard-type="step">
                                        <div class="kt-wizard-v1__nav-body">
                                            <div class="kt-wizard-v1__nav-icon">
                                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" class="kt-svg-icon kt-svg-icon--xl">
                                                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                                        <rect x="0" y="0" width="24" height="24"/>
                                                        <rect fill="#000000" opacity="0.3" x="2" y="5" width="20" height="14" rx="2"/>
                                                        <rect fill="#000000" x="2" y="8" width="20" height="3"/>
                                                        <rect fill="#000000" opacity="0.3" x="16" y="14" width="4" height="2" rx="1"/>
                                                    </g>
                                                </svg> </div>
                                            <div class="kt-wizard-v1__nav-label">
                                                Waiting Approval Payment
                                            </div>
                                        </div>
                                    </div>
                                    <div class="kt-wizard-v1__nav-item" id="ctstepEmpat" data-ktwizard-type="step">
                                        <div class="kt-wizard-v1__nav-body">
                                            <div class="kt-wizard-v1__nav-icon">
                                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" class="kt-svg-icon kt-svg-icon--xl">
                                                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                                        <rect x="0" y="0" width="24" height="24"/>
                                                        <path d="M4,4 L11.6314229,2.5691082 C11.8750185,2.52343403 12.1249815,2.52343403 12.3685771,2.5691082 L20,4 L20,13.2830094 C20,16.2173861 18.4883464,18.9447835 16,20.5 L12.5299989,22.6687507 C12.2057287,22.8714196 11.7942713,22.8714196 11.4700011,22.6687507 L8,20.5 C5.51165358,18.9447835 4,16.2173861 4,13.2830094 L4,4 Z" fill="#000000" opacity="0.3"/>
                                                        <path d="M12,11 C10.8954305,11 10,10.1045695 10,9 C10,7.8954305 10.8954305,7 12,7 C13.1045695,7 14,7.8954305 14,9 C14,10.1045695 13.1045695,11 12,11 Z" fill="#000000" opacity="0.3"/>
                                                        <path d="M7.00036205,16.4995035 C7.21569918,13.5165724 9.36772908,12 11.9907452,12 C14.6506758,12 16.8360465,13.4332455 16.9988413,16.5 C17.0053266,16.6221713 16.9988413,17 16.5815,17 C14.5228466,17 11.463736,17 7.4041679,17 C7.26484009,17 6.98863236,16.6619875 7.00036205,16.4995035 Z" fill="#000000" opacity="0.3"/>
                                                    </g>
                                                </svg> </div>
                                            <div class="kt-wizard-v1__nav-label">
                                                Waiting Activated User
                                            </div>
                                        </div>
                                    </div>
                                    <div class="kt-wizard-v1__nav-item" id="ctstepLima" data-ktwizard-type="step">
                                        <div class="kt-wizard-v1__nav-body">
                                            <div class="kt-wizard-v1__nav-icon">
                                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" class="kt-svg-icon kt-svg-icon--xl">
                                                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                                        <polygon points="0 0 24 0 24 24 0 24"/>
                                                        <path d="M16.5,4.5 C14.8905,4.5 13.00825,6.32463215 12,7.5 C10.99175,6.32463215 9.1095,4.5 7.5,4.5 C4.651,4.5 3,6.72217984 3,9.55040872 C3,12.6834696 6,16 12,19.5 C18,16 21,12.75 21,9.75 C21,6.92177112 19.349,4.5 16.5,4.5 Z" fill="#000000" fill-rule="nonzero" opacity="0.3"/>
                                                        <path d="M12,19.5 C6,16 3,12.6834696 3,9.55040872 C3,6.72217984 4.651,4.5 7.5,4.5 C9.1095,4.5 10.99175,6.32463215 12,7.5 L12,19.5 Z" fill="#000000" fill-rule="nonzero"/>
                                                    </g>
                                                </svg> </div>
                                            <div class="kt-wizard-v1__nav-label">
                                                Process Training
                                            </div>
                                        </div>
                                    </div>
                                    <div class="kt-wizard-v1__nav-item" id="ctstepEnam" data-ktwizard-type="step">
                                        <div class="kt-wizard-v1__nav-body">
                                            <div class="kt-wizard-v1__nav-icon">
                                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" class="kt-svg-icon kt-svg-icon--xl">
                                                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                                        <rect x="0" y="0" width="24" height="24" />
                                                        <path d="M13.2070325,4 C13.0721672,4.47683179 13,4.97998812 13,5.5 C13,8.53756612 15.4624339,11 18.5,11 C19.0200119,11 19.5231682,10.9278328 20,10.7929675 L20,17 C20,18.6568542 18.6568542,20 17,20 L7,20 C5.34314575,20 4,18.6568542 4,17 L4,7 C4,5.34314575 5.34314575,4 7,4 L13.2070325,4 Z" fill="#000000" />
                                                        <circle fill="#000000" opacity="0.3" cx="18.5" cy="5.5" r="2.5" />
                                                    </g>
                                                </svg> </div>
                                            <div class="kt-wizard-v1__nav-label">
                                                Complete / Done
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!--end: Form Wizard Nav -->
                        </div>
                        <div class="kt-grid__item kt-grid__item--fluid kt-wizard-v1__wrapper">

                            <!--begin: Form Wizard Form-->
                            <form class="kt-form" id="kt_projects_add_form">

                                <!--begin: Form Wizard Step 1-->
                                <div class="kt-wizard-v1__content" id="stepSatu" data-ktwizard-type="step-content" >
                                    <div class="kt-heading kt-heading--md">Assign Leads:</div>
                                    <div class="kt-section kt-section--first">
                                        <div class="kt-wizard-v1__form">
                                            <div class="row">
                                                <div class="col-xl-12">
                                                    <div class="kt-section__body">
                                                        <div class="form-group row">
                                                            <label class="col-xl-3 col-lg-3 col-form-label">Leads Name</label>
                                                            <div class="col-lg-9 col-xl-9">
                                                                <select class="form-control" id="idleads" name="idleads"></select>
                                                            </div>
                                                        </div>
                                                        <div class="form-group row">
                                                            <label class="col-xl-3 col-lg-3 col-form-label">PIC Partner</label>
                                                            <div class="col-lg-9 col-xl-9">
                                                                <select class="form-control" id="idpartner" name="idpartner"></select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!--end: Form Wizard Step 1-->

                                <!--begin: Form Wizard Step 2-->
                                <div class="kt-wizard-v1__content forPartner" id="stepDua" data-ktwizard-type="step-content">
                                    <div class="kt-section kt-section--first">
                                        <div class="kt-wizard-v1__form">
                                            <div class="row">
                                                <div class="col-xl-12">
                                                    <div class="kt-section__body">
                                                        <div class="form-group row">
                                                            <div class="col-lg-9 col-xl-6">
                                                                <h3 class="kt-section__title kt-section__title-md">Contract Form<small id="leadsName"> for Leads ABC</small></h3>
                                                            </div>
                                                        </div>
                                                        <div class="form-group row">
                                                            <label class="col-xl-3 col-lg-3 col-form-label">Status</label>
                                                            <div class="col-lg-9 col-xl-9">
                                                                <input type="hidden" disabled id="idcontract" class="form-control">
                                                                <input type="text" disabled id="statusContract" class="form-control" placeholder="Status">
                                                            </div>
                                                        </div>
                                                        <div class="form-group row">
                                                            <label class="col-xl-3 col-lg-3 col-form-label">Date Submitted</label>
                                                            <div class="col-lg-9 col-xl-9">
                                                                <input type="text" disabled id="datesubmit" class="form-control" placeholder="Date Submitted">
                                                            </div>
                                                        </div>
                                                        <div class="form-group row">
                                                            <label class="col-xl-3 col-lg-3 col-form-label">PIC / Partner</label>
                                                            <div class="col-lg-9 col-xl-9">
                                                                <input type="text" disabled id="pic" class="form-control" placeholder="PIC / Partner">
                                                            </div>
                                                        </div>
                                                        <div class="form-group row">
                                                            <label class="col-xl-3 col-lg-3 col-form-label">Contract Start Date</label>
                                                            <div class="col-lg-9 col-xl-9">
                                                                <input type="date" id="contractDateStart" class="form-control" placeholder="Contract Start Date">
                                                            </div>
                                                        </div>
                                                        <div class="form-group row">
                                                            <label class="col-xl-3 col-lg-3 col-form-label">Contract End Date</label>
                                                            <div class="col-lg-9 col-xl-9">
                                                                <input type="date" id="contractDateEnd" class="form-control" placeholder="Contract End Date">
                                                            </div>
                                                        </div>
                                                        <div class="form-group row">
                                                            <label class="col-xl-3 col-lg-3 col-form-label">Package</label>
                                                            <div class="col-lg-9 col-xl-9">
                                                                <select class="form-control" id="idpackage" name="idpackage"></select>
                                                            </div>
                                                        </div>
                                                        <div class="form-group row">
                                                            <label class="col-xl-3 col-lg-3 col-form-label">Contract Value</label>
                                                            <div class="col-lg-9 col-xl-9">
                                                                <input type="number" disabled id="contractValue" class="form-control" placeholder="Contract Value">
                                                            </div>
                                                        </div>
                                                        <div class="form-group row">
                                                            <label class="col-xl-3 col-lg-3 col-form-label">File Attachment</label>
                                                            <div class="col-lg-9 col-xl-9">
                                                                <input type="file" id="fileAttach" class="form-control">
                                                            </div>
                                                        </div>
                                                        <div class="form-group row">
                                                            <label class="col-xl-3 col-lg-3 col-form-label">Note</label>
                                                            <div class="col-lg-9 col-xl-9">
                                                                <textarea id="note" class="form-control"></textarea>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!--end: Form Wizard Step 2-->

                                <!--begin: Form Wizard Step 3-->
                                <div class="kt-wizard-v1__content forFinance" id="stepTiga" data-ktwizard-type="step-content">
                                    <div class="kt-heading kt-heading--md">Waiting Approval Payment</div>
                                    <div class="kt-form__section kt-form__section--first">
                                        <div class="kt-wizard-v1__form">
                                            <div class="form-group">
                                                <label>Contract Number</label>
                                                <span class="form-text text-muted" id="contractNumber"></span>
                                            </div>
                                            <div class="form-group">
                                                <label>Client Name</label>
                                                <span class="form-text text-muted" id="clientName"></span>
                                            </div>
                                            <div class="form-group">
                                                <label>File Attachment</label>
                                                <span class="form-text text-muted" id="fileAttachmentOpen"></span>
                                            </div>
                                            <div class="form-group">
                                                <label>Contract Value</label>
                                                <span class="form-text text-muted" id="contractValueOpen"></span>
                                            </div>
                                            <div class="form-group">
                                                <label>Note</label>
                                                <span class="form-text text-muted" id="noteOpen"></span>
                                            </div>

                                            <div class="row">
                                                <div class="col-md-6">
                                                    <button class="btn btn-primary btn-block" onclick="financeAct('approve')">Approve</button>
                                                </div>
                                                <div class="col-md-6">
                                                    <button class="btn btn-danger btn-block" onclick="financeAct('reject')">Reject</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!--end: Form Wizard Step 3-->

                                <!--begin: Form Wizard Step 4-->
                                <div class="kt-wizard-v1__content" id="stepEmpat" data-ktwizard-type="step-content">
                                    <div class="kt-heading kt-heading--md">Waiting Activated User by Internal</div>
                                    <div class="kt-form__section kt-form__section--first">
                                        <div class="kt-wizard-v1__form">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>Contract Number</label>
                                                        <span class="form-text text-muted" id="contractNumber2"></span>
                                                    </div>
                                                </div>
                                                <div class="col-md-6 pull-right">
                                                    <div class="form-group" style="float:right">
                                                        <label>Client Name</label>
                                                        <span class="form-text text-muted" id="clientName2"></span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label>File Attachment</label>
                                                <span class="form-text text-muted" id="fileAttachmentOpen2"></span>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-4">
                                                    <div class="form-group">
                                                        <label>Contract Value</label>
                                                        <span class="form-text text-muted" id="contractValueOpen2"></span>
                                                    </div>
                                                </div>
                                                <div class="col-md-4">
                                                    <div class="form-group">
                                                        <label>Commision</label>
                                                        <span class="form-text text-muted" id="commision2"></span>
                                                    </div>
                                                </div>
                                                <div class="col-md-4">
                                                    <div class="form-group">
                                                        <label>Final Income</label>
                                                        <span class="form-text text-muted" id="finalIncome"></span>
                                                        <span class="form-text text-muted" id="memberID"></span>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="form-group">
                                                <label>Assign PIC SUpport</label>
                                                <select class="form-control" id="idsupport" name="assignPIC"></select>
                                            </div>
                                            <div class="form-group">
                                                <label>Note</label>
                                                <span class="form-text text-muted" id="noteOpen2"></span>
                                            </div>

                                            <div class="row">
                                                <div class="col-md-6">
                                                    <button class="btn btn-primary btn-block" onclick="internalAct('approve')">Approve Member</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!--end: Form Wizard Step 3-->

                                <!--begin: Form Wizard Step 5-->
                                <div class="kt-wizard-v1__content" id="stepLima" data-ktwizard-type="step-content">
                                    <div class="kt-heading kt-heading--md">Process Training</div>
                                    <div class="kt-form__section kt-form__section--first">
                                        <div class="kt-wizard-v1__form">
                                            <div class="form-group">
                                                <label>User Feedback</label>
                                                <textarea name="feedback" class="form-control" id="feedback" cols="30" rows="10"></textarea>
                                                <span class="form-text text-muted">Please enter your Feedback.</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!--end: Form Wizard Step 5-->

                                <!--begin: Form Wizard Step 6-->
                                <div class="kt-wizard-v1__content" id="stepEnam" data-ktwizard-type="step-content">
                                    <div class="kt-heading kt-heading--md">Review your Details and Submit</div>
                                    <div class="kt-form__section kt-form__section--first">
                                        <div class="kt-wizard-v1__review">
                                            <div class="kt-wizard-v1__review-item">
                                                <div class="kt-wizard-v1__review-title">
                                                    Project Details
                                                </div>
                                                <div class="kt-wizard-v1__review-content">
                                                    Loop Inc CRM App
                                                    <br /> Phone: +61412345678
                                                    <br /> Email: johnwick@reeves.com
                                                </div>
                                            </div>
                                            <div class="kt-wizard-v1__review-item">
                                                <div class="kt-wizard-v1__review-title">
                                                    Delivery Address
                                                </div>
                                                <div class="kt-wizard-v1__review-content">
                                                    Address Line 1
                                                    <br /> Address Line 2
                                                    <br /> Melbourne 3000, VIC, Australia
                                                </div>
                                            </div>
                                            <div class="kt-wizard-v1__review-item">
                                                <div class="kt-wizard-v1__review-title">
                                                    Payment Details
                                                </div>
                                                <div class="kt-wizard-v1__review-content">
                                                    Card Number: xxxx xxxx xxxx 1111
                                                    <br /> Card Name: John Wick
                                                    <br /> Card Expiry: 01/21
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!--end: Form Wizard Step 6-->

                                <!--begin: Form Actions -->
                                <div class="kt-form__actions">
                                    <div class="btn btn-secondary btn-md btn-tall btn-wide kt-font-bold kt-font-transform-u" data-ktwizard-type="action-prev">
                                        Previous
                                    </div>
                                    <div class="btn btn-success btn-md btn-tall btn-wide kt-font-bold kt-font-transform-u" data-ktwizard-type="action-submit">
                                        Submit
                                    </div>
                                    <div onclick="confirmAssign()" class="btn btn-brand btn-md btn-tall btn-wide kt-font-bold kt-font-transform-u" data-ktwizard-type="action-next">
                                        Next Step
                                    </div>
                                </div>

                                <!--end: Form Actions -->
                            </form>

                            <!--end: Form Wizard Form-->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!--begin::Page Scripts(used by this page) -->
<script src="../../layout/assets/js/pages/custom/projects/add-project.js" type="text/javascript"></script>

<script>
$(document).ready(function(){
    getDataListOptionCountry('list_country','country','country');
    getDataListOptionCountry('list_leads','idleads','leads');
    getDataListOptionCountry('list_package','idpackage','package');
    getDataListOptionCountry('list_partner','idpartner','account');
    getDataListOptionCountry('list_support','idsupport','users');

    checkContract();

    $("#pic").val(localStorage.getItem('username'));

    $("#idpackage").change(function() {
        var v = $(this),
            selected = v.children('option:selected').data('val');
            dataval = selected;
        $("#contractValue").val(dataval);
    })
    
    
})

function internalAct(){
    swal.fire({
        type: 'info',
        title: 'Info',
        text:"Apakah Anda yakin ingin menyetujui member?",
        showCancelButton: true,
        confirmButtonText: 'Setuju',
        cancelButtonText: 'Batal',
        showLoaderOnConfirm: true,
        allowOutsideClick: false,
    })
    .then((result) => {
        if (result.dismiss=='cancel') {
            return
        }else{
            fireApproveInternal();
        }
    });
}

function fireApproveInternal() {
    var memberID = $("#memberID").html();
    var contract_number = $("#contractNumber").html();
    var contractValue = $("#contractValue").val();
    var idcontract = $("#idcontract").val();
    var assignPIC = $("#assignPIC").val();
    var idleads = $('#idleads').val();
    var iduser = localStorage.getItem('id');
    $.ajax({
        url: api_url + 'update_contract',
        data : {
            contract_number:contract_number ,
            contractValue:contractValue ,
            idcontract:idcontract ,
            idleads:idleads ,
            ct_start_date: $('#contractDateStart').val(),
            ct_end_date: $('#contractDateEnd').val(),
            idcontract: $('#idcontract').val(),
            idpackage: $('#idpackage').val(),
            iduser:iduser ,
            idmember:memberID ,
            step: localStorage.getItem('stepContract')
        },
        method: 'post',
        dataType: 'json',
        success:function(dt){
            if(dt.success){
                typeswal = "success";
                var url = "balance/list.html",
                    modul = "Contract",
                    title = "List";
                moveUrl(url,modul,title,'','');
            }else{
                typeswal = "error";
            }
            swal.fire({
                type: typeswal,
                title: 'Information',
                text: dt.msg
            })
            
        },
        error:function(xhr){
            swal.fire({
                type: 'error',
                title: 'Oops',
                text: xhr.status + " - " + xhr.statusText
            })
        }
    })
    
}

function financeAct(ack) {
    var idct = $("#idcontract").val();
    if(ack=='approve'){
        var text = "Apakah anda yakin ingin menyetujui Contract?";
        var htmlApprove = '<div class="form-group">'
                          +' <label>Contract Value</label>'
                          +' <input type="text" class="form-control" disabled name="contractValue" value="'+$("#contractValueOpen").html()+'" name="contract_value_open" placeholder="">'
                          +' </div>'
                          + '<div class="form-group">'
                          +' <label>Commision</label>'
                          +' <input type="text" class="form-control" name="commision" placeholder="Input commision">'
                          +'  <span class="form-text text-muted">Please input commision.</span>'
                          +' </div>'
                          +' <div class="form-group">'
                          +' <label>Reason</label>'
                          +' <input type="text" class="form-control" name="reason" placeholder="Reason">'
                          +'  <span class="form-text text-muted">Please enter your Reason.</span>'
                          +' </div>';
        swal.fire({
            type: 'info',
            title: 'Info',
            html: htmlApprove,
            showCancelButton: true,
            confirmButtonText: 'Setuju',
            cancelButtonText: 'Batal',
            showLoaderOnConfirm: true,
            allowOutsideClick: false,
        })
        .then((result) => {
            if (result.dismiss=='cancel') {
                return
            }else{
                fireApprove();
            }
        });
    }else{
        var text = "Apakah anda yakin ingin menolak Contract?";
        
        swal.fire({
            type: 'question',
            text: text,
            input: 'text',
            inputAttributes: {
                autocapitalize: 'off'
            },
            showCancelButton: true,
            confirmButtonText: 'Setuju',
            cancelButtonText: 'Batal',
            showLoaderOnConfirm: true,
            preConfirm: (login) => {
                return fetch(api_url + 'reject_contract?id='+idct+'&reasons='+login)
                .then(response => {
                    if (!response.ok) {
                    throw new Error(response.statusText)
                    }
                    return response.json()
                })
                .catch(error => {
                    swal.showValidationMessage(
                    `Request failed: ${error}`
                    )
                })
            },
            allowOutsideClick: () => !swal.isLoading()
        })
        .then((result) => {
            if (result.value) {
                swal.fire({
                    title: 'Success',
                    text: "Success reject contract"
                })
            }
        })
    }
}

function fireApprove(additional=""){
    var feedback = "";
    if(additional!=""){
        feedback = $("#feedback").val();
    }
    var contract_number = $("#contractNumber").html();
    var contractValue = $("#contractValue").val();
    var commision = $("input[name='commision']").val();
    var reason = $("input[name='reason']").val();
    var idcontract = $("#idcontract").val();
    var idleads = $('#idleads').val();
    var iduser = localStorage.getItem('id');
    $.ajax({
        url: api_url + 'update_contract',
        data : {
            contract_number:contract_number ,
            contractValue:contractValue ,
            commision:commision ,
            reason:reason ,
            idcontract:idcontract ,
            idleads:idleads ,
            feedback:feedback,
            ct_start_date: $('#contractDateStart').val(),
            ct_end_date: $('#contractDateEnd').val(),
            idcontract: $('#idcontract').val(),
            idpackage: $('#idpackage').val(),
            iduser:iduser ,
            step: localStorage.getItem('stepContract')
        },
        method: 'post',
        dataType: 'json',
        success:function(dt){
            if(dt.success){
                typeswal = "success";
                var url = "balance/list.html",
                    modul = "Contract",
                    title = "List";
                moveUrl(url,modul,title,'','');
            }else{
                typeswal = "error";
            }
            swal.fire({
                type: typeswal,
                title: 'Information',
                text: dt.msg
            })
            
        },
        error:function(xhr){
            swal.fire({
                type: 'error',
                title: 'Oops',
                text: xhr.status + " - " + xhr.statusText
            })
        }
    })
}

function checkContract() {
    var step = localStorage.getItem('stepContract'),stepAfter = [];
    if(step!=null){

        if(step==1){
            step = "stepDua";
            stepAfter = ["stepTiga","stepEmpat","stepLima","stepEnam"];
        }else if(step==2){
            $(".kt-form__actions").hide();
            step = "stepTiga";
            stepAfter = ["stepEmpat","stepLima","stepEnam"];
        }else if(step==3){
            $(".kt-form__actions").hide();
            step = "stepEmpat";
            stepAfter = ["stepLima","stepEnam"];
        }else if(step==4){
            step = "stepLima";
            stepAfter = ["stepEnam"];
        }else if(step==5){
            step = "stepEnam";
        }
        $('.kt-wizard-v1__nav-item').attr('data-ktwizard-state','done');
        $('.kt-wizard-v1__content').attr('data-ktwizard-state','done');

        stepAfter.map(function(el,i){
            $('#ct'+el).attr('data-ktwizard-state','pending');
            $('#'+el).attr('data-ktwizard-state','pending');
        });
        
        $("#ct"+step).attr('data-ktwizard-state','current');
        $("#"+step).attr('data-ktwizard-state','current');
    }else{
        var stepAfter = ["stepDua","stepTiga","stepEmpat","stepLima","stepEnam"]
        stepAfter.map(function(el,i){
            $('#ct'+el).attr('data-ktwizard-state','pending');
            $('#'+el).attr('data-ktwizard-state','pending');
        });
        $("#ctstepSatu").attr('data-ktwizard-state','current');
        $("#stepSatu").attr('data-ktwizard-state','current');
    }
}

function confirmAssign(){
    swal.fire({
        title: 'Informasi',
        text: "Apakah anda sudah pastikah bahwa data yang anda masukan benar ?",
        // icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Ya, Sudah',
        cancelButtonText: 'Belum',
      }).then((result) => {
        if (result.value) {
            var step = localStorage.getItem('stepContract');
            if(step!=null){
                if(step==1){
                    inputContract();
                }else if(step==2){
                    inputCommisionAndApproval();
                }else if(step==4){
                    fireApprove('tambahan');
                }
            }else{
                saveLeads();
            }
        }else{

        }
      });
}

function saveLeads(){
    $.ajax({
        url: api_url + 'add_contract',
        method: 'POST',
        dataType: 'json',
        data : {
            iduser: localStorage.getItem('id'),
            idpackage: $('#idpackage').val(),
            idleads: $('#idleads').val(),
            idpartner: $('#idpartner').val()
        },
        success:function(dt){
            if(dt.success){
                typeswal = "success";
            }else{
                typeswal = "error";
            }
            swal.fire({
                type: typeswal,
                title: 'Information',
                text: dt.msg
            })
            var url = "balance/list.html",
                modul = "Contract",
                title = "List";
            moveUrl(url,modul,title,'','');
        },
        error:function(xhr){
            swal.fire({
                type: 'error',
                title: 'Oops',
                text: xhr.status + " - " + xhr.statusText
            })
        }
    })
}

function inputContract(){
    $.ajax({
        url: api_url + 'update_contract',
        method: 'POST',
        dataType: 'json',
        data : {
            step: localStorage.getItem('stepContract'),
            iduser: localStorage.getItem('id'),
            idleads: $('#idleads').val(),
            contract_number: $('#leadsName').html(),
            username: localStorage.getItem('username'),
            ct_start_date: $('#contractDateStart').val(),
            ct_end_date: $('#contractDateEnd').val(),
            idcontract: $('#idcontract').val(),
            idpackage: $('#idpackage').val(),
            note: $('#note').val()
        },
        success:function(dt){
            if(dt.success){
                typeswal = "success";
            }else{
                typeswal = "error";
            }
            var file = document.getElementById('fileAttach').files[0];
            var reader = new FileReader();
            if (file != undefined) {
                reader.readAsDataURL(file);
                reader.onload = shipOff;
                var name = datePHPJS('His') + file.name;
                
                updateFoto(name, dt.idcontracts);

            }

            swal.fire({
                type: typeswal,
                title: 'Information',
                text: dt.msg
            });
        },
        error:function(xhr){
            swal.fire({
                type: 'error',
                title: 'Oops',
                text: xhr.status + " - " + xhr.statusText
            })
        }
    })
}


function shipOff(event) {
        var result = event.target.result;
        var fileName = datePHPJS('His') + document.getElementById('fileAttach').files[0].name;
        $.ajax({
            url: api_url + 'Contract/addAttachment',
            method: 'post',
            data: {data: result, name: fileName},
            success: function (dt) {
                var url = "balance/list.html",
                    modul = "Contract",
                    title = "List";
                moveUrl(url,modul,title,'','');
            }
        })
    }
    function updateFoto(name, id) {
        $.ajax({
            url: api_url + 'contract/updateDataContract',
            data: {id: id, name: name},
            method: 'post',
            success: function (data) {
            }
        })
    }


</script>